# Test the Detector Model by Sending Inputs<a name="iotevents-iot-rules-engine"></a>

This topic shows you how to create an AWS IoT rule in the AWS IoT Core console that forwards messages as inputs to your AWS IoT Events detector\. Then you use the AWS IoT Core console's MQTT client to send some test messages\.

1. Open the [AWS IoT core console](https://console.aws.amazon.com/iot/home)\. In the navigation pane, choose **Act**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/select-act.png)

1. On the **Rules** page, choose **Create**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/rules-create.png)

1. On the **Create a rule** page, enter a **Name** and **Description**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/rule-name.png)

1. Scroll down the page\. In the **Rule query statement**, enter the following\.

   ```
   SELECT *, topic(2) as motorid FROM 'motors/+/status'
   ```  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/rule-query-stmt.png)

1. Scroll down the page\. In **Set one or more actions**, choose **Add action**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/add-action.png)

1. On the **Select an action** page, scroll down and select **Send a message to an AWS IoT Events Input**, and then choose **Configure action**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/select-events-action.png)

1. On the **Configure action** page, choose the **Input name** you created in the previous section\. For **Role**, choose **Create Role**\. In the **Create a new role** window, enter a **Name** for a new role \(one with permission to forward messages to AWS IoT Events will be created\), and then choose **Create role**\. Back on the **Configure action** page, choose **Add action**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/configure-action.png)

1. On the **Create a rule** page, choose **Create rule**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/select-create-rule.png)

1. On the **Rules** page, in the navigation pane, choose **Test**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/go-test.png)

1. On the **MQTT client** page, choose **Publish to a topic**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/publish-topic.png)

1. In the **Publish** section, enter the topic, enter the following payload in the editor, and then choose **Publish**\.

   ```
   {
     "sensorData": {
       "pressure": 23,
       "temperature": 47
     }
   }
   ```  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/publish-message-1.png)

1. For **Publish**, keep the topic the same, but change the `"pressure"` in the payload to a value greater than the threshold value you specified in the detector model \(for example, 85\)\. Then choose **Publish**\.  
![\[Image NOT FOUND\]](http://docs.aws.amazon.com/iotevents/latest/developerguide/images/publish-message-2.png)

You should receive an Amazon SNS message generated by the detector instance that was created\. Continue to send messages with pressure readings above or below the pressure threshold \(70 for this example\) to see the detector in operation\. 

In our example here, you must send three messages with pressure readings below the threshold to transition back to the **Normal** state and receive an SNS message indicating the overpressure condition has cleared\. Once back in the **Normal** state, one message with a pressure reading above the limit will cause the detector to enter the **Dangerous** state and send an SNS message indicating that condition\.